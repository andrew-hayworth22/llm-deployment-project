version: "1.0.0"
services:
  vllm:
    image: vllm/vllm-openai:latest
    command: >
      --model facebook/opt-1.3b
      --dtype auto
      --max-model-len 4096
      --port 8000
    ports: ["8000:8000"]
    environment:
      - NVIDIA_VISIBLE_DEVICES=0
      - CUDA_MPS_ACTIVE_THREAD_PERCENTAGE=60

  tgi:
    image: ghcr.io/huggingface/text-generation-inference:latest
    command: >
      --model-id facebook/opt-1.3b
      --max-input-length 2048
      --max-total-tokens 4096
      --port 8080
    ports: ["8080:8080"]
    environment:
      - NVIDIA_VISIBLE_DEVICES=0
      - CUDA_MPS_ACTIVE_THREAD_PERCENTAGE=40
